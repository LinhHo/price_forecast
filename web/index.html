<!DOCTYPE html>
<html>
<head>
  <title>Electricity Price Forecast</title>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>
<body>

<h2>Electricity Price Forecast</h2>

<label>Zone:</label>
<select id="zone"></select>

<label>Forecast from:</label>
<input type="datetime-local" id="date" />

<button onclick="predict()">Predict</button>

<div id="chart"></div>

<script>
async function loadZones() {
  const res = await fetch("/zones");
  const zones = await res.json();

  const select = document.getElementById("zone");
  zones.forEach(z => {
    const opt = document.createElement("option");
    opt.value = z;
    opt.text = z;
    select.appendChild(opt);
  });
}

async function predict() {
  const zone = document.getElementById("zone").value;
  const date = document.getElementById("date").value;

  const res = await fetch(
    `/predict?zone=${zone}&date_to_predict=${date}Z`
  );
  const data = await res.json();

  Plotly.newPlot("chart", [
    {
      x: data.timestamps,
      y: data.p50,
      name: "P50",
    },
    {
      x: data.timestamps,
      y: data.p10,
      name: "P10",
      line: { dash: "dot" },
    },
    {
      x: data.timestamps,
      y: data.p90,
      name: "P90",
      line: { dash: "dot" },
    },
  ]);
}

loadZones();
</script>

</body>
</html>
